<!DOCTYPE html>
<html lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<meta charset="UTF-8">
<title>Cards Collector's</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/style.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="javascript/style.js"></script>
<link rel="shortcut icon" href="#">
</head>
<body th:onload="installListeners([[${sessionData.getScrollPosition()}]]);">
	<div class = "container-fluid scroller">
		<div class="row" style="margin-top:56px;">
			<div id="verticalmenu" class="col-pixel-width vertical-menu">
				<div class="vertical-menu-top">
					<button id="rarities" type="button" class="btn-block">Rarities
						<img th:src="@{${sessionData.getExpanders().get('rarities') ? 'images/hide.png' : 'images/expand.png'}}">
					</button>
				</div>
				<div th:style="'display: ' + ${sessionData.getExpanders().get('rarities') ? 'block' : 'none;'}">
					<div th:each="rarity : ${rarities}">
						<div th:if="${rarity.value}" th:with="start=${#strings.startsWith(selectedRarities, rarity.key.getId())}, end=${#strings.endsWith(selectedRarities, rarity.key.getId())}">
							<div th:if="${start or end}">
								<div th:if="${start}" th:classappend="${rarity.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.substringAfter(selectedRarities, rarity.key + ',')}">
									<a class="btn-block" th:href="@{/gallery(__${#strings.isEmpty(replace) ? ',' : 'rarity=${replace}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${rarity.key.getId()}"></a>
								</div>
								<div th:if="${end and !start}" th:classappend="${rarity.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.substringBefore(selectedRarities, ',' + rarity.key)}">
									<a class="btn-block" th:href="@{/gallery(__${#strings.isEmpty(replace) ? ',' : 'rarity=${replace}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${rarity.key.getId()}"></a>
								</div>
							</div>
							<div th:unless="${start or end}"  th:classappend="${rarity.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.replace(selectedRarities, rarity.key + ',', '')}">
								<a class="btn-block" th:href="@{/gallery(__${#strings.isEmpty(replace) ? ',' : 'rarity=${replace}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${rarity.key.getId()}"></a>
							</div>
						</div>
						<div th:unless="${rarity.value}">
							<a class="btn-block" th:href="@{/gallery(rarity=${selectedRarities + (selectedRarities == '' ? '' : ',') + rarity.key},__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${rarity.key.getId()}"></a>
						</div>
					</div>
				</div>
				<div class="vertical-menu-top">
					<button id="sets" type="button" class="btn-block">Sets
						<img th:src="@{${sessionData.getExpanders().get('sets') ? 'images/hide.png' : 'images/expand.png'}}">
					</button>
				</div>
				<div th:style="'display: ' + ${sessionData.getExpanders().get('sets') ? 'block' : 'none;'}">
					<div th:each="set : ${sets}">
						<div th:if="${set.value}" th:with="start=${#strings.startsWith(selectedSets, set.key.getId())}, end=${#strings.endsWith(selectedSets, set.key.getId())}">
							<div th:if="${start or end}">
								<div th:if="${start}" th:classappend="${set.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.substringAfter(selectedSets, set.key + ',')}">
									<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${#strings.isEmpty(replace) ? ',' : 'set=${replace}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${set.key.getId()}"></a>
								</div>
								<div th:if="${end and !start}" th:classappend="${set.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.substringBefore(selectedSets, ',' + set.key)}">
									<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${#strings.isEmpty(replace) ? ',' : 'set=${replace}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${set.key.getId()}"></a>
								</div>
							</div>
							<div th:unless="${start or end}"  th:classappend="${set.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.replace(selectedSets, set.key + ',', '')}">
								<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${#strings.isEmpty(replace) ? ',' : 'set=${replace}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${set.key.getId()}"></a>
							</div>
						</div>
						<div th:unless="${set.value}">
							<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,set=${selectedSets + (selectedSets == '' ? '' : ',') + set.key},__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${set.key.getId()}"></a>
						</div>
					</div>
				</div>
				<div class="vertical-menu-top">
					<button id="types" type="button" class="btn-block">Types
						<img th:src="@{${sessionData.getExpanders().get('types') ? 'images/hide.png' : 'images/expand.png'}}">
					</button>
				</div>
				<div th:style="'display: ' + ${sessionData.getExpanders().get('types') ? 'block' : 'none'}">
					<div th:each="type : ${types}">
						<div th:if="${type.value}" th:with="start=${#strings.startsWith(selectedTypes, type.key.getId())}, end=${#strings.endsWith(selectedTypes, type.key.getId())}">
							<div th:if="${start or end}">
								<div th:if="${start}" th:classappend="${type.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.substringAfter(selectedTypes, type.key + ',')}">
									<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${#strings.isEmpty(replace) ? ',' : 'type=${replace}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${type.key.getId()}"></a>
								</div>
								<div th:if="${end and !start}" th:classappend="${type.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.substringBefore(selectedTypes, ',' + type.key)}">
									<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${#strings.isEmpty(replace) ? ',' : 'type=${replace}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${type.key.getId()}"></a>
								</div>
							</div>
							<div th:unless="${start or end}"  th:classappend="${type.value == true ? 'vertical-menu-selected' : ''}" th:with="replace=${#strings.replace(selectedTypes, type.key + ',', '')}">
								<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${#strings.isEmpty(replace) ? ',' : 'type=${replace}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${type.key.getId()}"></a>
							</div>
						</div>
						<div th:unless="${type.value}">
							<a class="btn-block" th:href="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,type=${selectedTypes + (selectedTypes == '' ? '' : ',') + type.key},__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:text="${type.key.getId()}"></a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row" style="margin-left:215px;">
			<div class="col">
				<div class="row">
					<div class="col px-0">
						<div class="fixed-top" style="margin-top:56px; margin-left:230px;">
							<div class="topnav">
								<a class="disabled active"> Sort By</a>
					  			<div th:each="sortOption : ${sortOptions}">
					 	 			<form th:action="@{/sort(page=${currentPage},__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" method="post">
					 	 				<button type="submit" th:name="sort" th:value="${sortOption}" th:text="${sortOption.getName()}" th:classappend="${sessionData.getSortType() == sortOption ? 'active' : ''}"></button>
					 	 			</form>
					 	 		</div>
					  			<div onmouseover="changeDropdownColor();" onmouseout="returnDropdownColor();" class="dropdown">
  									<button id="dropdown">Order By
  										<img src="images/expand.png">
  									</button>
									<div class="dropdown-content">
 										<form th:action="@{/order(page=${currentPage},__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__,__${enteredSearch == '' ? ',' : 'search=${enteredSearch}'}__)}" th:each="orderType : ${sessionData.getSortType().orderTypeValues()}" method="post">
						  					<button type="submit" th:name="order" th:value="${orderType}" th:text="${orderType.getName()}" th:classappend="${sessionData.getOrderType() == orderType ? 'active' : ''}"></button>
					  					</form>
									</div>
								</div> 
					  			<div class="search-container">
					  				<div class="form-inline">
   										<form id="search-form" th:action="@{/gallery(__${selectedRarities == '' ? ',' : 'rarity=${selectedRarities}'}__,__${selectedSets == '' ? ',' : 'set=${selectedSets}'}__,__${selectedTypes == '' ? ',' : 'type=${selectedTypes}'}__)}" method="post">
   											<input type="text" class="form-control mr-2" id="search" th:name="search" th:value="${enteredSearch == '' ? '' : enteredSearch}" placeholder="Search ...">
 										</form>
 										<button onclick="eraseSearch();" class="btn">
 										   		<img th:src="@{images/cancel.png}" class="center" width="18" height="20" alt="C">
 										</button>
 										<button type="submit" form="search-form" class="btn">
   												<img th:src="@{images/search.png}" class="center" width="18" height=20 alt="S">
   										</button>
 									</div>
 								</div>
							</div>
						</div>
					</div>
				</div>
				<div th:replace="cards :: cards"></div>
			</div>
		</div>
	</div>
	<div th:replace="menu :: menu"></div>
</body>
</html>